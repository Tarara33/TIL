[参考](https://pikawaka.com/word/ec2)

# EC2とは
Amazon EC2はAWSで仮想サーバーを構築するサービスの1つ。  
仮想化技術で、物理的なサーバーを仮想的に分割して使えるようにするもの。  
アプリを動かすサーバー！

~~~
+------------------+
|   物理サーバー     　|
|　　(例: 1台のサーバー)　　|
|                  |
+------------------+

↓

+------------------+
|  EC2インスタンス 1  |
|  (仮想的なサーバー) |
|                  |
+------------------+
|  EC2インスタンス 2  |
|  (仮想的なサーバー) |
|                  |
+------------------+
|  EC2インスタンス 3  |
|  (仮想的なサーバー) |
|                  |
+------------------+
~~~
***

# 準備するもの
## [VPC](https://github.com/Tarara33/TIL/blob/main/%E3%82%B5%E3%83%BC%E3%83%90%E3%83%BC/AWS/VPC.md)を作っておく
どのネットワークを使うのかで必要となる。
***

## キーペアを作る(初回)
EC2にログインするときに使う。  

- EC2コンテナの左メニューで「ネットワーク & セキュリティ」の中にある。  
- 名前とペアタイプを入れる。(今回はRSAタイプ)
- 作成を押すと、ファイルがダウンロードされるので無くさないように！

[![Image from Gyazo](https://i.gyazo.com/b4e10123f04c8abc5f948fce0fe07cf6.png)](https://gyazo.com/b4e10123f04c8abc5f948fce0fe07cf6)

***

# EC2を作る
EC2コンテナの左メニューからインスタンスを選択して、インスタンスの起動を押す。  

## 名前とタグ
インスタンス名となる部分
***

## Application and OS Images (Amazon Machine Image) 
インスタンスの OS部分を選ぶ
⚠️ 料金かかるものある
***

## インスタンスタイプ
インスタンスの性能を決める
⚠️ 性能があがるにつれ、料金も上がる
***

## キーペアの登録
作ったキーペアを登録する
***

## ネットワーク設定
作った VPCとサブネットを登録する。
***

## 高度な設定
今回は省略
***

# インスタンスの状態
開始・停止・再起動に関してはそのままの意味。    
休止はインスタンスのシャットダウンを意味する。  
終了はインスタンスの削除を意味する。  

⚠️ インスタンスの状態が「停止中、停止」なら課金されないが、「休止中、休止」だと課金対象となる。
***

# インスタンスへログイン
インスタンスを作成したらインスタンスの状態が「起動」になってるのを確認して、接続を押す。  

「SSHクライアント」タブをクリックすると、接続のコマンドが出てくるので、ターミナルからそのコマンドを入力する。  
ターミナルで下記のようになれば OK
~~~
[ec2-user@... ~]$
~~~
***

# ⭐️ ElasticIP
先ほど作成した EC2は停止して再度起動すると、パブリックIPが変わり、毎回 sshログインが必要になる。  
これを固定の　IPアドレスを割り当てると毎回のログインがいらなくなる。

- EC2コンテナの左メニューで「ネットワーク & セキュリティ」の中にある。
- 「Elastic IP アドレスを割り当てる」からフォームへ。
- 特にそのままで作成 OK
***

## ElasticIPを紐付ける
先ほど作った ElasticIPを選択して右上のアクションから「ElasticIPアドレスの関連付け」に進んで、   
関連させるインスタンスを選択する。

[![Image from Gyazo](https://i.gyazo.com/a74c0052f0cfdcac82a1aef44d02e7d3.png)](https://gyazo.com/a74c0052f0cfdcac82a1aef44d02e7d3)

⚠️ ElasticIPは保有していると料金がかかる。(その IPアドレスを他者は使えないのでレンタル料的な)  
使わないなら右上のアクションから「ElasticIPアドレスの解放」を選んで解放する。
***
