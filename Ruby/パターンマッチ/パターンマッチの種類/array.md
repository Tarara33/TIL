# array
[ここ](https://github.com/Tarara33/TIL/blob/main/Ruby/%E3%83%91%E3%82%BF%E3%83%BC%E3%83%B3%E3%83%9E%E3%83%83%E3%83%81/%E3%83%91%E3%82%BF%E3%83%BC%E3%83%B3%E3%83%9E%E3%83%83%E3%83%81%E3%81%A8%E3%81%AF.md#%E9%85%8D%E5%88%97%E7%B7%A8)でも書いた、配列の場合のパターン。  
in節に配列の構造パターンを指定する。  
***

# 要素数が同じかのマッチ
配列の要素の数が同じかを変数を代入してマッチさせる。
~~~
case [1, 2, 3]
in [a, b, c]
  "a = #{a}, b = #{b}, c = #{c}"
end

=> "a = 1, b = 2, c = 3"
~~~
***

## 配列は入れ子構造でもOK
~~~
case [1, [2, 3]]
in [a, [b, c]]
  "a = #{a}, b = #{b}, c = #{c}"
end

=> "a = 1, b = 2, c = 3"
~~~

または、配列を一つの要素のまま代入もできる。
~~~
case [1, [2, 3]]
in [a, b]
  "a = #{a}, b = #{b}"
end

=> "a = 1, b = [2, 3]"
~~~
***

# 数値や文字列が同じかのマッチ
変数ではなく、数値や文字列をそのまま in節に指定すると「その値と等しいか」がマッチの条件となる。
~~~
case [1, 20, 300]
in [1, 20, 300]
  puts "マッチします"
end

=> マッチします
~~~

## 一部だけ変数にもできる
配列の要素数は 3。かつ最初と最後が 1, 300であればマッチ。  
2番めの要素は nとして任意のものが入る。
~~~
case [1, 20, 300]
in [1, n, 300]
  puts "n = #{n}です。 マッチします"
end

=> n = 20です。マッチします
~~~
***

# 条件指定もできる
たとえば、  
- 配列の要素数は 3。
- 一番目の要素は String型。
- 二番目の要素は数値 10以上。
- 三番目の要素は nとして任意のものが入る。
~~~
case ["Alice", 999, 3]
in [String, 10.., n]
  puts "n = #{n}です。 マッチします"
end

=> n = 3です。マッチします
~~~
***

## 💡 指定した条件の中身も使いたい
上記のコードだと、条件として使った String型は特に変数に代入されていないので putsで出ない。
~~~
case ["Alice", 999, 3]
in [String, 10.., n]
  puts "String = #{String}です。 n = #{n}です。 マッチします"
end

=> String = Stringです。 n = #{n}です。 マッチします
~~~

⭐️ この場合`条件 => 変数名`とすると putsなどで中身使える！！
~~~
case ["Alice", 999, 3]
in [String => str, 10.., n]
  puts "String = #{str}です。 n = #{n}です。 マッチします"
end

=> String = Aliceです。 n = 3です。 マッチします
~~~
***

# *で任意の長さの要素を指定できる
たとえば、
- 最初の要素が 1であればマッチ。
- 二番目以降は任意(0個以上)
~~~
case [1, 2, 3, 4, 5]
in [1, *rest]
  puts "余った要素は #{rest}"
end

=> 余った要素は [2, 3, 4, 5]
~~~
💡 もし余った要素を特に使わないなら`*変数名`とせず、`*`だけでOK。
***

もちろん最後でなくても使える。  
- 最初が 1,最後が 5であればマッチ。
- 中間は任意(0個以上)
~~~
case [1, 2, 3, 4, 5]
in [1, *rest, 5]
  puts "余った要素は #{rest}"
end

=> 余った要素は [2, 3, 4]
~~~
***

# ⚠️ 注意点
## 同じ変数名は使えない。
~~~
case [1, 1, 3]
in [a, a, c]
  "a = #{a}, b = #{a}, c = #{c}"
end

=> エラー
~~~

もし、要素1 と要素2 が同じことを指定して、変数に代入したいなら[ピン演算子](https://github.com/Tarara33/TIL/blob/main/Ruby/%E3%83%91%E3%82%BF%E3%83%BC%E3%83%B3%E3%83%9E%E3%83%83%E3%83%81/%E3%83%91%E3%82%BF%E3%83%BC%E3%83%B3%E3%83%9E%E3%83%83%E3%83%81%E3%81%AE%E7%A8%AE%E9%A1%9E/variable.md#%E3%83%94%E3%83%B3%E6%BC%94%E7%AE%97%E5%AD%90)使う。  
~~~
case [1, 1, 3]
in [a, ^a, c]
  puts "a = #{a}, b = #{a}, c = #{c}"
end

=> a = 1, b = 1, c = 3
~~~
***

### `_`なら何回でも使える。
特に代入して使う必要がないなら[`_`](https://github.com/Tarara33/TIL/blob/main/Ruby/%E3%83%A1%E3%83%A2/%E5%A4%89%E6%95%B0.md#%E4%BD%BF%E3%82%8F%E3%81%AA%E3%81%84%E5%A4%89%E6%95%B0)で使わない変数として何回でも使える。  
~~~
case [1, 1, 3]
in [a, _, c]
  puts "a = #{a}, c = #{c}"
end

=> a = 1, c = 3
~~~
***

## 最初の`[]`は省略可能
in節で使っている`[]`は一番外側なら省略可能である。
~~~
case [1, 2, 3]
in a, b, c
  "a = #{a}, b = #{b}, c = #{c}"
end


case [1, [2, 3]]
in a, [b, c]
  "a = #{a}, b = #{b}, c = #{c}"
end
~~~
***
