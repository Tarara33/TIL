# 実行するテストケースを限定する設定
spec_helper.rbの 50行目付近にある
~~~
[spec/spec_helper.rb]

=begin
  # This allows you to limit a spec run to individual examples or groups
  # you care about by tagging them with `:focus` metadata. When nothing
  # is tagged with `:focus`, all examples get run. RSpec also provides
  # aliases for `it`, `describe`, and `context` that include `:focus`
  # metadata: `fit`, `fdescribe` and `fcontext`, respectively.
⭕️config.filter_run_when_matching :focus
~~~
    
⭕️部分をコメントアウト外したいので、上にある「=begin」を動かす。
~~~
[spec/spec_helper.rb]

  # This allows you to limit a spec run to individual examples or groups
  # you care about by tagging them with `:focus` metadata. When nothing
  # is tagged with `:focus`, all examples get run. RSpec also provides
  # aliases for `it`, `describe`, and `context` that include `:focus`
  # metadata: `fit`, `fdescribe` and `fcontext`, respectively.
⭕️config.filter_run_when_matching :focus
=begin
~~~
***

## 使いかた
describe、content、itなどのテストブロックの頭に 「f」を付けるだけで、そのテストブロックのみが実行されるようになる。
~~~
RSpec.describe 'Users', type: :system do
  describe 'ログイン前' do
    describe 'ユーザー新規登録' do
      context 'フォームの入力値が正常' do
        it 'ユーザーの新規作成が成功する' do
          # テストは省略
        end
      end
      context 'メールアドレスが未入力' do
          # 実行したいテストブロックに f をつける。
        ⭕️fit 'ユーザーの新規作成が失敗する' do
          # テストは省略
        end
      end
~~~
***

# 実行画面を見やすくする
~~~
[.rspec]
--format documentation
~~~
通常は...でテスト通過がわかるが、
[![Image from Gyazo](https://i.gyazo.com/a128f249804dcbdce42392c327ae293e.png)](https://gyazo.com/a128f249804dcbdce42392c327ae293e)  
    
describeや context、itの文章が入って見やすくなる。    
[![Image from Gyazo](https://i.gyazo.com/902215d1f36479312b48dbfd2c146a8c.png)](https://gyazo.com/902215d1f36479312b48dbfd2c146a8c)    
***

# テスト内での変数
~~~
context '登録済のメールアドレスを使用' do
  before do
    user = create(:user)
  end
  it 'ユーザーの新規作成が失敗する' do
    visit sign_up_path
    fill_in 'Email', with: user.email
~~~
例えばこのようなコードの時、先に 変数userを作成して、itの中で user.emailとするとエラーが出る。    
なぜなら、変数はブロック(before do~endなど)を超えて使えないため。    
⭐️ ブロック超えて使いたいなら、インスタンス変数にする。
~~~
context '登録済のメールアドレスを使用' do
  before do
    @user = create(:user)
  end
  it 'ユーザーの新規作成が失敗する' do
    visit sign_up_path
    fill_in 'Email', with: @user.email
~~~
***

# rails c はサンドボックスモードで
例えば、このようなFactoryBotファイルを設定して、    
そのデーターを確認したくて rails cで入力すると、
~~~
[spec/factries/user.rb]
FactoryBot.define do
  factory :user do
    sequence(:email) { |n| "user_#{n}@example.com" }
    password {'password'}
    password_confirmation {'password'}
  end
end


[rails c]
$ user = FactoryBot.craete(:user)
=> => #<User:0x0000000108e233b8
 id: 3,
 email: "user_1@example.com",
 crypted_password:...
~~~
実際にデータベースにコレが登録されてしまう。    
    
そして exitしてもう一度同じことをすると、    
FactoryBotはまた「user_1@example.com」から作ろうとするので、    
emailにユニーク制度かけていた場合、そのemailは存在しますとエラーが出る。    
    
無駄にテストデータも増えてしまうし、テストが動かなくなったり厄介なので    
基本的にRspecのデーターはデータベースに登録しない。    
そのためサンドボックスモードにする。
***

