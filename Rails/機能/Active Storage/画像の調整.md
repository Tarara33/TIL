# Active Storageã§æ·»ä»˜ã—ãŸç”»åƒã®èª¿æ•´
- è¨˜äº‹ã®ç”»åƒã®æ¨ªå¹…ã‚µã‚¤ã‚ºã‚’ 100~700pxã§å¤‰ãˆãŸã„ã€‚  
[![Image from Gyazo](https://i.gyazo.com/a9af44412cc7083b9c0d27737e220ef9.png)](https://gyazo.com/a9af44412cc7083b9c0d27737e220ef9)      
[![Image from Gyazo](https://i.gyazo.com/59a4d674cceece93db7bb3f52726baad.png)](https://gyazo.com/59a4d674cceece93db7bb3f52726baad)  

- ç”»åƒã®ä½ç½®ã‚’ã€å·¦å¯„ã›ãƒ»ä¸­å¤®ãƒ»å³å¯„ã›ã«å¤‰ãˆã‚Œã‚‹ã‚ˆã†ã«ã—ãŸã„ã€‚
[![Image from Gyazo](https://i.gyazo.com/8e1fcaafb16a451b0b9aafb949a5ef3b.png)](https://gyazo.com/8e1fcaafb16a451b0b9aafb949a5ef3b)
[![Image from Gyazo](https://i.gyazo.com/8f939a46fefa0f1b1f4edb5f67931507.png)](https://gyazo.com/8f939a46fefa0f1b1f4edb5f67931507)
[![Image from Gyazo](https://i.gyazo.com/8a34a321e09e373e5da8763d7672026a.png)](https://gyazo.com/8a34a321e09e373e5da8763d7672026a)  
***

# ãƒ¢ãƒ‡ãƒ«ã«ã‚«ãƒ©ãƒ è¿½åŠ 
Active Storageã‚’å°å…¥ã—ã¦ã„ã‚‹ãƒ¢ãƒ‡ãƒ«ã«ç”»åƒã‚µã‚¤ã‚ºç”¨ã®ã‚«ãƒ©ãƒ ã¨ç”»åƒä½ç½®ç”¨ã®ã‚«ãƒ©ãƒ ã‚’è¿½åŠ ã€‚
~~~
$ rails g migration add_column_to_articles
~~~
~~~
[ãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«]

class AddColumnToArticles < ActiveRecord::Migration[5.2]
  def change
    add_column :articles, :eyecatch_width, :integer
    add_column :articles, :eyecatch_align, :integer, default: 0, null: false
  end
end
~~~
âš ï¸ :eyecatch_widthã¯ not nullã¤ã‘ã‚‹ã¨ã€ç”»åƒæ·»ä»˜ã•ã‚Œã¦ãªã„æ™‚ã«ã‚¨ãƒ©ãƒ¼ã«ãªã‚‹ã®ã§ã¤ã‘ãªã„ã€‚
~~~
$ rails db:migrate
~~~
***

# enumè¨­å®š
~~~
[app/models/article.rb]

enum eyecatch_align: { left: 0, center: 1, right: 2 }
~~~
***

# ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã®è¨­å®š
æ¨ªå¹…ã‚’ 100~700pxã«ã™ã‚‹ã®ã§ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã‹ã‘ã‚‹ã€‚
~~~
[app/models/article.rb]

validates :eyecatch_width, numericality: { less_than_or_equal_to: 700, greater_than_or_equal_to: 100 }, allow_blank: true
~~~
â­ï¸ numericality:  
å±æ€§ã«æ•°å€¤ã®ã¿ãŒä½¿ã‚ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’æ¤œè¨¼ã™ã‚‹ã€‚
  
â­ï¸ less_than_or_equal_to: / greater_than_or_equal_to:  
numericality: ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã€‚  
- less_than_or_equal_to:...æŒ‡å®šã®å€¤ã¨ç­‰ã—ã„ã‹ã€ãã‚Œã‚ˆã‚Šã‚‚å°ã•ããªã‘ã‚Œã°ãªã‚‰ãªã„ã“ã¨ã‚’æŒ‡å®šã™ã‚‹ã€‚  
- greater_than_or_equal_to:...æŒ‡å®šã®å€¤ã¨ç­‰ã—ã„ã‹ã€ãã‚Œã‚ˆã‚Šã‚‚å¤§ãããªã‘ã‚Œã°ãªã‚‰ãªã„ã“ã¨ã‚’æŒ‡å®šã™ã‚‹ã€‚ 
***

# ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼ç·¨é›†
è¿½åŠ ã—ãŸã‚«ãƒ©ãƒ ãŒå—ã‘å–ã‚Œã‚‹ã‚ˆã†ã«ã‚¹ãƒˆãƒ­ãƒ³ã‚°ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãƒ¼ç·¨é›†ã™ã‚‹ã€‚  
~~~
[app/controllers/article_controller.rb]

def article_params
  params.require(:article).permit(:title, :description, :slug, :state, :published_at, :eye_catch, :category_id, :author_id, :eyecatch_width, :eyecatch_align, tag_ids: [])
end
~~~
âš ï¸ tag_ids: []ã®å¾Œã«è¿½åŠ ã—ãŸã‚‰ãªãœã‹ã‚¨ãƒ©ãƒ¼å‡ºãŸã€‚
ã‚·ãƒ³ãƒœãƒ«é¡ã¯å‰åŠã§ã¾ã¨ã‚ãŸæ–¹ãŒã„ã„ã¿ãŸã„ã€‚
***

# ãƒ“ãƒ¥ãƒ¼ã®ç·¨é›†(ãƒ•ã‚©ãƒ¼ãƒ )
simple_formã«ã¤ã„ã¦ã¯[ã“ã¡ã‚‰](https://github.com/Tarara33/TIL/blob/main/Rails/Gem/simple_form.md)
~~~
[app/views/articles/new.html.erb]

<%= simple_form_for @article, url: admin_article_path(@article.uuid) do |f| %>

  <%= f.input :eyecatch_width, placeholder: '100'  %>      
  <%= f.input_field :eyecatch_align, as: :radio_buttons %>
~~~
***

# ãƒ“ãƒ¥ãƒ¼ã®ç·¨é›†(è¡¨ç¤º)
ç”»åƒè¡¨ç¤ºéƒ¨åˆ†ã®classã‚’å‹•çš„ã«å‡ºåŠ›ã™ã‚‹ã€‚
~~~
[app/views/articles/show.html.erb]

<% if @article.eye_catch.attached? %>
  <section class="eye_catch ğŸ©µtext-<%= @article.eyecatch_align %>">
    <%= image_tag @article.eye_catch_url(:lg), class: 'img-fluid', ğŸ’šwidth: @article.eyecatch_width %>
  </section>
<% end %>
~~~
ğŸ©µ é›£ã—ãè€ƒãˆã¦åˆ¤å®šãƒ­ã‚¸ãƒƒã‚¯ãªã©ã‚’ãƒ˜ãƒ«ãƒ‘ãƒ¼ãƒ¡ã‚½ãƒƒãƒ‰ã¨ã—ã¦ä½œã‚‰ãªãã¦ã‚‚ã€  
eyecatch_alignã® enumã‚’åˆ©ç”¨ã—ã¦ class="text-right", class="text-center", class="text-left"   
ã‚’å‡ºåŠ›ã™ã‚‹ã‚ˆã†ã«ã™ã‚Œã°ã€ç°¡å˜ã«ç”»åƒã®ä½ç½®ã‚’å¤‰æ›´ã™ã‚‹ã“ã¨ãŒã§ãã‚‹ã€‚  

ğŸ’š widthã‚‚ eyecatch_widthã®æ•°å€¤ã‚’å…¥ã‚Œã‚Œã°é©å¿œã•ã‚Œã‚‹ã€‚
***



