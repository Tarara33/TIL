#### ã‚«ãƒ©ãƒ ã®è¿½åŠ ãƒ»ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼ä½œæˆ/ä¿®æ­£ãƒ»ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°è¨­å®šã¾ã§

# Userãƒ¢ãƒ‡ãƒ«ã« Adminã‚’åˆ¤åˆ¥ã™ã‚‹ã‚«ãƒ©ãƒ ã®è¿½åŠ 
ç®¡ç†è€…ã‹ã©ã†ã‹ã‚’è¦‹åˆ†ã‘ã‚‹ ã€Œroleã€ã¨ã„ã†ã‚«ãƒ©ãƒ ã‚’è¿½åŠ ã™ã‚‹ã€‚    
~~~
$ rails g migration AddRoleToUsers role:integer
~~~
    
ãã—ã¦ã€ã§ããŸãƒã‚¤ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ•ã‚¡ã‚¤ãƒ«ã®è¨­å®šã€‚
~~~
[æ—¥ä»˜_add_role_to_users.rb]

  def change
    add_column :users, :role, :integer, default: 0, null: false
â­•ï¸=> 0 or 1ã§ç®¡ç†è€…ã‹ã©ã†ã‹è¦‹åˆ†ã‘ã‚‹ã€‚ 0ã‚’ä¸€èˆ¬ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«ã™ã‚‹ã®ã§ã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã‚’ 0ã«ã™ã‚‹ã€‚
  end
~~~
***

# enumã®è¨­å®š
enumã¨ã¯ã€ãƒ¢ãƒ‡ãƒ«ã®æ•°å€¤ã‚«ãƒ©ãƒ ã«å¯¾ã—ã¦æ–‡å­—åˆ—ã«ã‚ˆã‚‹åå‰ã‚’ä»˜ã‘ã‚Œã‚‹ã‚ˆã†ã«ãªã‚‹ä»•çµ„ã¿ã€‚    
å…ˆã»ã©ã® roleã‚«ãƒ©ãƒ ã‚’ä¾‹ã«ã™ã‚‹ã¨ã“ã†ãªã‚‹ã€‚    
0: general(ä¸€èˆ¬ãƒ¦ãƒ¼ã‚¶ãƒ¼)    
1: admin(ç®¡ç†è€…)    
~~~
[app/models/users.rb]
enum role: %i[general admin]
enum role: {general: 0, admin: 1}

æ›¸ãæ–¹é•ã†ãŒã€ã©ã¡ã‚‰ã‚‚åŒã˜å‹•ãã‚’ã™ã‚‹ã€‚
~~~
***

# ç®¡ç†è€…ç”¨ã®ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼ä½œæˆ
ä»Šã¾ã§ã®ä½œã‚Šæ–¹ã ã¨ã€ã©ã‚ŒãŒç®¡ç†è€…ç”¨ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼ã‹åˆ†ã‹ã‚Šã«ãã„ã€‚
~~~
$ rails g controller Admins
~~~   
[![Image from Gyazo](https://i.gyazo.com/f1da0bd6b294be0ca49a4cd4f39b662c.png)](https://gyazo.com/f1da0bd6b294be0ca49a4cd4f39b662c)    
***       
        
ãã®ãŸã‚ã€Œãƒãƒ¼ãƒ ã‚¹ãƒšãƒ¼ã‚¹ã€ã‚’ã¤ã‘ã‚‹ã¨åˆ†ã‹ã‚Šã‚„ã™ããªã‚‹ã€‚        
[ãƒãƒ¼ãƒ ã‚¹ãƒšãƒ¼ã‚¹](https://github.com/Tarara33/TIL/blob/main/Rails/Rails%E3%83%A1%E3%83%A2/%E5%90%8D%E5%89%8D%E7%A9%BA%E9%96%93.md)
~~~
$ rails g controller Admin::Base
~~~
[![Image from Gyazo](https://i.gyazo.com/ef31cab3f1b164d4eb482ab845b53aa2.png)](https://gyazo.com/ef31cab3f1b164d4eb482ab845b53aa2)
***

## Base Controllerã¨ã¯ï¼Ÿï¼Ÿ
ã¾ãšã€ applicationã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼ã¯ã€ãã“ã§è¨­å®šã—ãŸæ©Ÿèƒ½ã¯å…¨ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼ã«é©å¿œã§ãã‚‹ã€‚        
ã—ã‹ã—ã€ã“ã®ã¾ã¾ã ã¨ Adminã¨ã„ã†åå‰ç©ºé–“ã‚’ã¤ã‘ãŸã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼ã¾ã§é©å¿œã•ã‚Œã¦ã—ã¾ã†ã€‚        
        
ãã“ã§ Adminã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼ãŸã¡ã«ã ã‘é©å¿œã™ã‚‹ã€        
applicationã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼ã®ã‚ˆã†ãªã‚‚ã®ã‚’ä½œã‚‹ãŸã‚ã«ã€ŒAdmin::BaseControllerã€ã‚’ä½œæˆã—ãŸã€‚                
ğŸ’¡ ã¤ã¾ã‚Šã€Admin::BaseControllerã§è¨­å®šã—ãŸã‚¢ã‚¯ã‚·ãƒ§ãƒ³ã¯ã€ãã®ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼ã‚’ç¶™æ‰¿ã—ã¦ã„ã‚‹å…¨ã¦ã®ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼ã«é©ç”¨ã•ã‚Œã‚‹ï¼
***

# ä»–ã®ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼ã‚‚ä½œæˆã™ã‚‹
- ç®¡ç†ç”»é¢ç”¨ã®ãƒˆãƒƒãƒ—ãƒšãƒ¼ã‚¸ã«é·ç§»ã™ã‚‹ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼
~~~
$ rails g controller Admin::Dashboards index
~~~

- ç®¡ç†è€…ã®ãƒ­ã‚°ã‚¤ãƒ³æ©Ÿèƒ½ã‚’æ‹…ã†ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼
~~~
$ rails g controller Admin::User_sessions new
~~~
***

# ç¶™æ‰¿ã®ä¿®æ­£
ç¾çŠ¶ã€æ–°ã—ãä½œã£ãŸï¼’ã¤ã®ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼ã¯ applicationã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ãƒ¼ã‚’ç¶™æ‰¿ã—ã¦ã„ã‚‹ã€‚
~~~
[app/controllers/admin/dashboards_controller.rb]
class Admin::DashboardsController < ApplicationController
  def index
  end
end


[app/controllers/admin/user_sessions_controller.rb]
class Admin::UserSessionsController < ApplicationController
  def new
  end
end
~~~
        
ãã“ã§ã€å…ˆã»ã©ä½œã£ãŸ Admin::BaseControllerã‚’ç¶™æ‰¿ã—ãŸã„ã®ã§ã€æ›¸ãæ›ãˆã‚‹ã€‚
~~~
[app/controllers/admin/dashboards_controller.rb]
class Admin::DashboardsController < Admin::BaseController
  def index
  end
end


[app/controllers/admin/user_sessions_controller.rb]
class Admin::UserSessionsController < Admin::BaseController
  def new
  end
end
~~~
***

# ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã®è¨­å®š
Adminã¨ã„ã†ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®åå‰ç©ºé–“ã‚’ä½¿ç”¨ã—ãŸã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ©ã‚’ä½œæˆã—ãŸã®ã§ã€ãã‚Œã«å¯¾å¿œã™ã‚‹ã‚ˆã†ã«ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã«ã‚‚åå‰ç©ºé–“ã‚’è¨­å®šã™ã‚‹ã€‚      
è¦ã™ã‚‹ã«ã€ã€Œlocalhost:3000/admin/ã€‡ã€‡ã€ã® URLã‚’ä½œã‚‹ã€‚        
[ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã®ãƒãƒ¼ãƒ ã‚¹ãƒšãƒ¼ã‚¹ã«ã¤ã„ã¦](https://github.com/Tarara33/TIL/blob/main/Rails/Controller/Routes.md)
~~~
[config/routes.rb]
namespace :admin do
    root to: 'dashboards#index'
=> /admin

    get 'login', to: 'user_sessions#new'
=> /admin/login

    post 'login', to: 'user_sessions#create'
=> /admin/login

    delete 'logout', to: 'user_sessions#destroy'
=> /admin/logout
end
~~~
[![Image from Gyazo](https://i.gyazo.com/d570651cad2b3da0d2c685ce367bfeea.png)](https://gyazo.com/d570651cad2b3da0d2c685ce367bfeea)
***


