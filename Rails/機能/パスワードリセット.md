# 必要なもの
1. SorceryのReset_Passwordモジュール
2. ActionMailer （Railsnに元々ある)
3. Gem letter_opener_web
4. Gem config
***

# Sorceryにモジュール導入・設定
[ここにまとめた](https://github.com/Tarara33/TIL/blob/main/Rails/Gem/sorcery/reset_password.md)
　***

# メーラーの作成
~~~
$ rails g mailer UserMailer(メーラークラス名) reset_password_email(クラス内のメソッド名)
~~~
***

# Sorceryの設定
今作った UserMailerをパスワードリセットに使用する ActionMailerとして定義する。
~~~
[config/initializars/sorceryrb]

# 369行目あたりにコメントアウトされてる。
user.reset_password_mailer = UserMailer
~~~
***


# リセット用コントローラーの設定
パスワードリセット時のおおまかな流れは、    

①パスワードリセットの申請画面に飛ぶ(newアクション)    
②パスワードリセット申請画面のフォームにユーザーのメールアドレスを記入してフォームを送る。        
③createアクション発動して、ユーザーが存在したらトークンが発行されてトークンの文字列がユーザーテーブルに保存される。    
  さらにparamsにトークンの文字列を含んだURLが貼り付けられたメールが送信される。    
④送られたメールのリンクからリダイレクトすると、editアクションが働き新しいパスワードを入力する画面が表示される。    
⑤フォームにパスワードを入力して更新すると、updateアクションが働きパスワードが変更される。
~~~
$ rails g controller ResetPassword create edit update
